# Issue

The `immutable` keyword has limited support after the regenesis on August 30th.

Attempting to deploy contracts that use `immutable` address variables return the following error:

```
Error: processing response error (body="{\"jsonrpc\":\"2.0\",\"error\":{\"code\":3,\"message\":\"Failed to submit transaction: Transaction requires too much gas to commit on L1\",\"data\":{\"code\":104,\"message\":\"Transaction requires too much gas to commit on L1\"}},\"id\":371}\n", error={"code":3,"data":{"code":104,"message":"Transaction requires too much gas to commit on L1"}}, requestBody="{\"method\":\"eth_sendRawTransaction\",\"params\":[\"0x71f914371a8405f5e1008405f5e1008402f61bc294000000000000000000000000000000000000800680b8c4e2e9718a000000000000000000000000000000000000000000000000000000000000000000973fab319c90f9d9065628bd2d6a54a40f48c42b93368502db53c7f44885ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f64bbdf5ba9cc079f20164fbfbefd31fb8e2e0ba82011880808201189469c7c048e7c286b0a8bcf7cd7620e71ef756942183027100f912e3b912e000000075011001970000007604000041000000000014037600000077010000410000000000210376000000000130004c000000080000613d01d000090000034f01d000770000034f00020000000000020000000001000357000000000110004c0000001c0000c13d00000077010000410000000003010375000000bf02300039000000200100008a000000000212016f000000a00420008a000000780440009c0000001e0000413d000000800100004100000000001003760000004101000039000000040200003900000000001203760000008101000041000001d2000103720000000001000019000001d2000103720000004008000039000000000028037600000077020000410000000002020375000000000220004c0000002c0000c13d000000a0010000390000000002000019000200000008001d000100000003001d01d001c10000034f000000010300002900000002080000290000004a0000013d0000001f0230018f000000760400004100000000090403750000000504300270000000000540004c0000003b0000613d0000000005000019000000050650021000000000076900190000000007070377000000a00660003900000000007603760000000105500039000000000645004b000000330000413d000000000420004c0000004a0000613d000000000113016f00000000051900190000000302200210000000a001100039000000000401037500000000042401cf000000000424022f00000000050503770000010002200089000000000525022f00000000022501cf000000000242019f000000000021037600000079010000410000001f0230008c000000000200001900000000020120190000007903300197000000000430004c0000000001008019000000790330009c000000000102c019000000000110004c000000570000c13d0000000001000019000001d200010372000000a00100003900000000010103750000007a0210009c0000005d0000413d0000000001000019000001d2000103720000008003000039000000000013037600000077020000410000000002020375000000000220004c0000006a0000c13d00000000010803750000000002000019000200000003001d000000000300001901d001c10000034f0000000201000029000000000101037500006ea0020000390000007b0300004100000000002303760000007c02000041000000000012037600000020010000390000007d02000041000000000012037600000376010000390000007e0200004100000000001203760000007f01000041000001d100010370000c0000000000020000000001000350000080020210008c000000940000613d0000000002000351000080010220008c000000940000613d000000820200004100000083030000410000000000230376000000840200004100000000001203760000800201000039000000850200004100000000030003560000000c0330008a00000020033000c901d001840000034f000000ff010000390000000b0110024f000000000110004c000000920000613d00000086010000410000000c0110017f0000000001010378000000000110004c000000940000c13d0000000001000019000001d10001037000000080030000390000004005000039000000000035037600000077010000410000000001010375000000030110008c000000b90000a13d000000760100004100000000010103750000000001010377000000e001100270000000870210009c000000bb0000613d000000880110009c000000b90000c13d0000000001000357000000000110004c000000d20000c13d00000077010000410000000001010375000000040110008a000000010200008a0000007903000041000000000221004b000000000200001900000000020320190000007901100197000000790410009c00000000030080190000007901100167000000790110009c00000000010200190000000001036019000000000110004c000000d60000c13d0000000001000019000001d2000103720000000001000019000001d2000103720000000001000357000000000110004c000000d40000c13d000400000003001d00000077010000410000000001010375000000040110008a000000010200008a0000007903000041000000000221004b000000000200001900000000020320190000007901100197000000790410009c00000000030080190000007901100167000000790110009c00000000010200190000000001036019000000000110004c000000f50000c13d0000000001000019000001d2000103720000000001000019000001d2000103720000000001000019000001d2000103720000000001050375000400000001001d00000089010000410000008302000041000000000012037600000000010003520000008402000041000000000012037600006ea0010000390000008a02000041000000000012037600008005010000390000008b020000410000000003000356000000060330008a00000020033000c901d001840000034f000000ff01000039000000050110024f000000010110008c0000000001000019000000f00000c13d0000008601000041000000060110017f00000000010103780000008c011001970000000402000029000000000012037600000086012001970000008d011001c7000001d100010370000300000005001d0000008e01000041000000040200002900000000001203760000000001000355000200000001001d00000089010000410000008302000041000000000012037600000000010003520000008402000041000000000012037600006ea0010000390000008a02000041000000000012037600008005010000390000008b0200004100000000030003560000000a0330008a00000020033000c901d001840000034f000000ff01000039000100000001001d000000090110024f000000010110008c0000000001000019000001190000c13d00000086010000410000000a0110017f00000000010103780000008c01100197000000040210008c000001190000c13d000000920100004100000000010103750000013b0000013d000000020200002900000060022002100000008f0220019700000090022001c70000000003000356000000080330008a00000020033000c9015801840000034f000000080100002900000086031001970000000102000029000000070220024f000000400110027000000086011001970000000004000019000000050540021000000000065300190000000006060378000000800550003900000000006503760000000105400039000000000445004b00000000040000190000000104004039000000010440018f000000000440004c0000000004050019000001280000c13d0000009104000041000000000034037600000092030000410000000000130376000000000220004c0000015d0000613d000000200210008c00000020010080390000007902000041000000200310008c000000000300001900000000030240190000007904100197000000000540004c000000000200a019000000790440009c00000000030260190000001f01100039000000600110018f00000080021001bf00000003040000290000000000240376000000000330004c0000014f0000613d0000000001000019000001d20001037200000004030000290000000003030375000001000430008c000001550000413d0000000001000019000001d200010372000000000032037600000095011001c7000001d1000103700000009101000041000000000001037600000092010000410000000000010376000000000100001900000093041001970000001f0310018f00000091020000410000000005020375000000030200002900000000020203750000000501100270000000000610004c0000016f0000613d0000000006000019000000050760021000000000087200190000000007750019000000000707037800000000007803760000000106600039000000000716004b000001670000413d000000000130004c0000017d0000613d000000000145001900000000044200190000000303300210000000000504037500000000053501cf000000000535022f00000000010103780000010003300089000000000131022f00000000013101cf000000000151019f000000000014037600000086012001970000009202000041000000000202037500000040022002100000009402200197000000000112019f000001d2000103720002000000000002000200000003001d0000002003300039000100000003001d0000019d002103650000000205000029000000200250011a000000000201001f0000000106000029000000202160011a000000000126004900000003022002100000010003200089000000200110011a000000010331025f000000000101003100000000042101cf000000000343019f000000000220004c000000000103c019000000200260011a00000079021001cd00000000010500190000000200000005000000000001036f0000000103000029000000020500002900000000020000190000000102004039000000010220018f000000000220004c000001b70000c13d000000200250011a000000000201001f0000000006030019000000202160011a000000000126004900000003022002100000010003200089000000200110011a000000010331025f000000000101003100000000042101cf000000000343019f000000000220004c000000000103c019000000200260011a000000960210019d00000000010500190000000200000005000000000001036f0000000000010371000000000401037500000000043401cf000000000434022f0000010003300089000000000232022f00000000023201cf000000000242019f0000000000210376000000000001036f0000000504300270000000000540004c000001c90000613d00000000002103760000002001100039000000010440008a000000000540004c000001c40000c13d0000001f0330018f000000000430004c000001cf0000613d000000030330021001d001b80000034f000000000001036f000000000001036f000001d000000374000001d100010370000001d200010372000000000000e0010000000000000000000000000000000000000000000000000000000000ffffff0000000000000000000000000000000000000000000000000000000000ffffe00000000000000000000000000000000000000000000000000000000000ffffc0000000000000000000000000000000000000000000000000ffffffffffffff60800000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e0dd800000000000000000000000000000000000000000000000000000000000e0dda00000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000e0002000000000000000000000000000000000000000000000ddc00000000000e000004e487b710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000000000000001806aa1896bbf26568e884a7374b41e002500962caba6a15023a8d90e8508b830000000000000000000000000000000000000000000000000000000000fff8000000000000000000000000000000000000000000000000000000000000fff8040000000000000000000000000000000000000000000000240000000000fff800000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000313ce56700000000000000000000000000000000000000000000000000000000fc0c546a310ab089e4439a4c15d089f94afb7896ff553aecb10793d0ab882de59d99a32e0000000000000000000000000000000000000000000000000000000000fff8240000000000000000000000000000000000000000000000440000000000fff800000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000200000000000000000313ce5670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000400000000000000800000000000000000000000000000000000000000000000000000000000ffffa00000000000000000000000000000000000000000000000000000000000ffff80000000000000000000000000000000000000000000000000ffffffffffffffe000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000000000000000000000000000000002000000000000000807fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffb84109c9acd96e77a89973fa09a6767c2011330eca7071395d40df16479020352da6502e54877a4455aa491ef34c392379d750accaafbb3fd3aeed61baabfec077661bc0\"],\"id\":371,\"jsonrpc\":\"2.0\"}", requestMethod="POST", url="https://zksync2-testnet.zksync.dev", code=SERVER_ERROR, version=web/5.7.0)
    at Logger.makeError (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)
    at Logger.throwError (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)
    at /Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/src.ts/index.ts:335:28
    at step (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:33:23)
    at Object.next (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:14:53)
    at fulfilled (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:5:58)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (node:internal/process/task_queues:96:5) {
  reason: 'processing response error',
  code: 'SERVER_ERROR',
  body: '{"jsonrpc":"2.0","error":{"code":3,"message":"Failed to submit transaction: Transaction requires too much gas to commit on L1","data":{"code":104,"message":"Transaction requires too much gas to commit on L1"}},"id":371}\n',
  error: Error: Failed to submit transaction: Transaction requires too much gas to commit on L1
      at getResult (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:142:28)
      at processJsonFunc (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/src.ts/index.ts:377:22)
      at /Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/src.ts/index.ts:314:42
      at step (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:33:23)
      at Object.next (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:14:53)
      at fulfilled (/Users/user/Projects/zksync/zksync-aug-regen/node_modules/@ethersproject/web/lib/index.js:5:58)
      at runMicrotasks (<anonymous>)
      at processTicksAndRejections (node:internal/process/task_queues:96:5) {
    code: 3,
    data: {
      code: 104,
      message: 'Transaction requires too much gas to commit on L1'
    }
  },
  requestBody: '{"method":"eth_sendRawTransaction","params":["0x71f914371a8405f5e1008405f5e1008402f61bc294000000000000000000000000000000000000800680b8c4e2e9718a000000000000000000000000000000000000000000000000000000000000000000973fab319c90f9d9065628bd2d6a54a40f48c42b93368502db53c7f44885ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f64bbdf5ba9cc079f20164fbfbefd31fb8e2e0ba82011880808201189469c7c048e7c286b0a8bcf7cd7620e71ef756942183027100f912e3b912e000000075011001970000007604000041000000000014037600000077010000410000000000210376000000000130004c000000080000613d01d000090000034f01d000770000034f00020000000000020000000001000357000000000110004c0000001c0000c13d00000077010000410000000003010375000000bf02300039000000200100008a000000000212016f000000a00420008a000000780440009c0000001e0000413d000000800100004100000000001003760000004101000039000000040200003900000000001203760000008101000041000001d2000103720000000001000019000001d2000103720000004008000039000000000028037600000077020000410000000002020375000000000220004c0000002c0000c13d000000a0010000390000000002000019000200000008001d000100000003001d01d001c10000034f000000010300002900000002080000290000004a0000013d0000001f0230018f000000760400004100000000090403750000000504300270000000000540004c0000003b0000613d0000000005000019000000050650021000000000076900190000000007070377000000a00660003900000000007603760000000105500039000000000645004b000000330000413d000000000420004c0000004a0000613d000000000113016f00000000051900190000000302200210000000a001100039000000000401037500000000042401cf000000000424022f00000000050503770000010002200089000000000525022f00000000022501cf000000000242019f000000000021037600000079010000410000001f0230008c000000000200001900000000020120190000007903300197000000000430004c0000000001008019000000790330009c000000000102c019000000000110004c000000570000c13d0000000001000019000001d200010372000000a00100003900000000010103750000007a0210009c0000005d0000413d0000000001000019000001d2000103720000008003000039000000000013037600000077020000410000000002020375000000000220004c0000006a0000c13d00000000010803750000000002000019000200000003001d000000000300001901d001c10000034f0000000201000029000000000101037500006ea0020000390000007b0300004100000000002303760000007c02000041000000000012037600000020010000390000007d02000041000000000012037600000376010000390000007e0200004100000000001203760000007f01000041000001d100010370000c0000000000020000000001000350000080020210008c000000940000613d0000000002000351000080010220008c000000940000613d000000820200004100000083030000410000000000230376000000840200004100000000001203760000800201000039000000850200004100000000030003560000000c0330008a00000020033000c901d001840000034f000000ff010000390000000b0110024f000000000110004c000000920000613d00000086010000410000000c0110017f0000000001010378000000000110004c000000940000c13d0000000001000019000001d10001037000000080030000390000004005000039000000000035037600000077010000410000000001010375000000030110008c000000b90000a13d000000760100004100000000010103750000000001010377000000e001100270000000870210009c000000bb0000613d000000880110009c000000b90000c13d0000000001000357000000000110004c000000d20000c13d00000077010000410000000001010375000000040110008a000000010200008a0000007903000041000000000221004b000000000200001900000000020320190000007901100197000000790410009c00000000030080190000007901100167000000790110009c00000000010200190000000001036019000000000110004c000000d60000c13d0000000001000019000001d2000103720000000001000019000001d2000103720000000001000357000000000110004c000000d40000c13d000400000003001d00000077010000410000000001010375000000040110008a000000010200008a0000007903000041000000000221004b000000000200001900000000020320190000007901100197000000790410009c00000000030080190000007901100167000000790110009c00000000010200190000000001036019000000000110004c000000f50000c13d0000000001000019000001d2000103720000000001000019000001d2000103720000000001000019000001d2000103720000000001050375000400000001001d00000089010000410000008302000041000000000012037600000000010003520000008402000041000000000012037600006ea0010000390000008a02000041000000000012037600008005010000390000008b020000410000000003000356000000060330008a00000020033000c901d001840000034f000000ff01000039000000050110024f000000010110008c0000000001000019000000f00000c13d0000008601000041000000060110017f00000000010103780000008c011001970000000402000029000000000012037600000086012001970000008d011001c7000001d100010370000300000005001d0000008e01000041000000040200002900000000001203760000000001000355000200000001001d00000089010000410000008302000041000000000012037600000000010003520000008402000041000000000012037600006ea0010000390000008a02000041000000000012037600008005010000390000008b0200004100000000030003560000000a0330008a00000020033000c901d001840000034f000000ff01000039000100000001001d000000090110024f000000010110008c0000000001000019000001190000c13d00000086010000410000000a0110017f00000000010103780000008c01100197000000040210008c000001190000c13d000000920100004100000000010103750000013b0000013d000000020200002900000060022002100000008f0220019700000090022001c70000000003000356000000080330008a00000020033000c9015801840000034f000000080100002900000086031001970000000102000029000000070220024f000000400110027000000086011001970000000004000019000000050540021000000000065300190000000006060378000000800550003900000000006503760000000105400039000000000445004b00000000040000190000000104004039000000010440018f000000000440004c0000000004050019000001280000c13d0000009104000041000000000034037600000092030000410000000000130376000000000220004c0000015d0000613d000000200210008c00000020010080390000007902000041000000200310008c000000000300001900000000030240190000007904100197000000000540004c000000000200a019000000790440009c00000000030260190000001f01100039000000600110018f00000080021001bf00000003040000290000000000240376000000000330004c0000014f0000613d0000000001000019000001d20001037200000004030000290000000003030375000001000430008c000001550000413d0000000001000019000001d200010372000000000032037600000095011001c7000001d1000103700000009101000041000000000001037600000092010000410000000000010376000000000100001900000093041001970000001f0310018f00000091020000410000000005020375000000030200002900000000020203750000000501100270000000000610004c0000016f0000613d0000000006000019000000050760021000000000087200190000000007750019000000000707037800000000007803760000000106600039000000000716004b000001670000413d000000000130004c0000017d0000613d000000000145001900000000044200190000000303300210000000000504037500000000053501cf000000000535022f00000000010103780000010003300089000000000131022f00000000013101cf000000000151019f000000000014037600000086012001970000009202000041000000000202037500000040022002100000009402200197000000000112019f000001d2000103720002000000000002000200000003001d0000002003300039000100000003001d0000019d002103650000000205000029000000200250011a000000000201001f0000000106000029000000202160011a000000000126004900000003022002100000010003200089000000200110011a000000010331025f000000000101003100000000042101cf000000000343019f000000000220004c000000000103c019000000200260011a00000079021001cd00000000010500190000000200000005000000000001036f0000000103000029000000020500002900000000020000190000000102004039000000010220018f000000000220004c000001b70000c13d000000200250011a000000000201001f0000000006030019000000202160011a000000000126004900000003022002100000010003200089000000200110011a000000010331025f000000000101003100000000042101cf000000000343019f000000000220004c000000000103c019000000200260011a000000960210019d00000000010500190000000200000005000000000001036f0000000000010371000000000401037500000000043401cf000000000434022f0000010003300089000000000232022f00000000023201cf000000000242019f0000000000210376000000000001036f0000000504300270000000000540004c000001c90000613d00000000002103760000002001100039000000010440008a000000000540004c000001c40000c13d0000001f0330018f000000000430004c000001cf0000613d000000030330021001d001b80000034f000000000001036f000000000001036f000001d000000374000001d100010370000001d200010372000000000000e0010000000000000000000000000000000000000000000000000000000000ffffff0000000000000000000000000000000000000000000000000000000000ffffe00000000000000000000000000000000000000000000000000000000000ffffc0000000000000000000000000000000000000000000000000ffffffffffffff60800000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e0dd800000000000000000000000000000000000000000000000000000000000e0dda00000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000e0002000000000000000000000000000000000000000000000ddc00000000000e000004e487b710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000000000000001806aa1896bbf26568e884a7374b41e002500962caba6a15023a8d90e8508b830000000000000000000000000000000000000000000000000000000000fff8000000000000000000000000000000000000000000000000000000000000fff8040000000000000000000000000000000000000000000000240000000000fff800000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000313ce56700000000000000000000000000000000000000000000000000000000fc0c546a310ab089e4439a4c15d089f94afb7896ff553aecb10793d0ab882de59d99a32e0000000000000000000000000000000000000000000000000000000000fff8240000000000000000000000000000000000000000000000440000000000fff800000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000200000000000000000313ce5670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000400000000000000800000000000000000000000000000000000000000000000000000000000ffffa000000000000000000000000000000000000000000000000000'... 434 more characters,
  requestMethod: 'POST',
  url: 'https://zksync2-testnet.zksync.dev',
  transaction: {
    type: 113,
    nonce: 26,
    maxPriorityFeePerGas: BigNumber { _hex: '0x05f5e100', _isBigNumber: true },
    maxFeePerGas: BigNumber { _hex: '0x05f5e100', _isBigNumber: true },
    gasLimit: BigNumber { _hex: '0x02f61bc2', _isBigNumber: true },
    to: '0x0000000000000000000000000000000000008006',
    value: BigNumber { _hex: '0x00', _isBigNumber: true },
    data: '0xe2e9718a000000000000000000000000000000000000000000000000000000000000000000973fab319c90f9d9065628bd2d6a54a40f48c42b93368502db53c7f44885ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f64bbdf5ba9cc079f20164fbfbefd31fb8e2e0ba',
    chainId: BigNumber { _hex: '0x0118', _isBigNumber: true },
    from: '0x69C7c048e7C286B0a8Bcf7cD7620E71Ef7569421',
    customData: {
      ergsPerPubdata: [BigNumber],
      factoryDeps: [Array],
      customSignature: '0x09c9acd96e77a89973fa09a6767c2011330eca7071395d40df16479020352da6502e54877a4455aa491ef34c392379d750accaafbb3fd3aeed61baabfec077661b',
      paymasterParams: undefined
    },
    hash: '0x873c44fe558b02888c5815515449678ca9a1bc30b3c47640a4373125eccf7eaf',
    confirmations: 0
  },
  transactionHash: '0x873c44fe558b02888c5815515449678ca9a1bc30b3c47640a4373125eccf7eaf'
}
```

## Steps to Reproduce

1. Clone this repo

`git clone https://github.com/omurovec/zksync-immutable-issue`

2. Install depenencies

`yarn`

3. Compile contracts

`yarn hardhat compile`

4. Deploy (fails)

`PK=<PRIVATE_KEY> yarn hardhat deploy-zksync`
